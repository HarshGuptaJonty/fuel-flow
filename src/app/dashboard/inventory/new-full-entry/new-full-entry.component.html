<div class="new-full-entry-container">
    <span class="heading bold-text">{{isEditing? 'Edit Entry':'Add New Entry'}}</span>

    <div *ngIf="!isEditing">Please provide the following details.</div>
    <div *ngIf="isEditing">Transaction ID: {{transactionId}}</div>

    <form [formGroup]="entryForm" #formSection class="customer-form mt-3">
        <div class="bold-text">Customer details.</div>
        <div class="gap d-flex w-100 flex-wrap pt-1">
            <div class="box-input p-relative">
                <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Full Name</mat-label>
                    <input matInput placeholder="Ankit" [maxLength]="30" autocomplete="off"
                        formControlName="customerName" (focus)="onfocus('customerName')">
                </mat-form-field>
                <div class="select-dropdown"
                    *ngIf="customerSearchList.length > 0 && focusedFormName === 'customerName'">
                    <div class="profile" *ngFor="let obj of customerSearchList" (click)="onSelectCustomer(obj)"
                        tabindex="0">
                        <span class="bold-text me-2">{{obj.data.fullName}}</span>
                        <span *ngIf="obj.data?.phoneNumber"
                            class="dropdown-number">{{formatNumber(obj.data.phoneNumber)}}</span>
                    </div>
                </div>
            </div>
            <div class="box-input p-relative">
                <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Phone Number</mat-label>
                    <input matInput placeholder="xxxx xxx xxx" prefix="+91 " [maxLength]="16" autocomplete="off"
                        mask="0000 000 000" formControlName="customerNumber" (focus)="onfocus('customerNumber')">
                </mat-form-field>
                <div class="select-dropdown"
                    *ngIf="customerSearchList.length > 0 && focusedFormName === 'customerNumber'">
                    <div class="profile" *ngFor="let obj of customerSearchList" (click)="onSelectCustomer(obj)"
                        tabindex="0">
                        <span class="bold-text me-2">{{obj.data.fullName}}</span>
                        <span *ngIf="obj.data?.phoneNumber"
                            class="dropdown-number">{{formatNumber(obj.data.phoneNumber)}}</span>
                    </div>
                </div>
            </div>
            <div class="box-input p-relative">
                <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Shipping Address</mat-label>
                    <input matInput placeholder="ABC Lane, XYZ Road 132002" autocomplete="off"
                        formControlName="shippingAddress" (focus)="onfocus('shippingAddress')">
                </mat-form-field>
                <div class="select-dropdown"
                    *ngIf="shippingAddressSearchList.length > 0 && focusedFormName === 'shippingAddress' && customerSelected">
                    <div class="profile" *ngFor="let address of shippingAddressSearchList" (click)="onSelectShippingAddress(address)"
                        tabindex="0">
                        <span class="bold-text me-2">{{address}}</span>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="!customerSelected && this.entryForm.get('customerName')?.value"
            class="small-text error-msg bold-text mt-1">New customer
            ({{this.entryForm.get('customerName')?.value}}) will be created!</div>
        <div class="mt-2 bold-text">Delivery person details.</div>
        <div class="gap d-flex w-100 flex-wrap pt-1">
            <div class="box-input p-relative">
                <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Full Name</mat-label>
                    <input matInput placeholder="Ankit" [maxLength]="30" autocomplete="off"
                        formControlName="deliveryBoyName" (focus)="onfocus('deliveryBoyName')">
                </mat-form-field>
                <div class="select-dropdown"
                    *ngIf="deliveryBoysSearchList.length > 0 && focusedFormName === 'deliveryBoyName'">
                    <div class="profile" *ngFor="let obj of deliveryBoysSearchList" (click)="onSelectDeliveryBoy(obj)"
                        tabindex="0">
                        <span class="bold-text me-2">{{obj.data.fullName}}</span>
                        <span *ngIf="obj.data?.phoneNumber"
                            class="dropdown-number">{{formatNumber(obj.data.phoneNumber)}}</span>
                    </div>
                </div>
            </div>
            <div class="box-input p-relative">
                <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Phone Number</mat-label>
                    <input matInput placeholder="xxxx xxx xxx" prefix="+91 " [maxLength]="16" autocomplete="off"
                        mask="0000 000 000" formControlName="deliveryBoyNumber" (focus)="onfocus('deliveryBoyNumber')">
                </mat-form-field>
                <div class="select-dropdown"
                    *ngIf="deliveryBoysSearchList.length > 0 && focusedFormName === 'deliveryBoyNumber'">
                    <div class="profile" *ngFor="let obj of deliveryBoysSearchList" (click)="onSelectDeliveryBoy(obj)"
                        tabindex="0">
                        <span class="bold-text me-2">{{obj.data.fullName}}</span>
                        <span *ngIf="obj.data?.phoneNumber"
                            class="dropdown-number">{{formatNumber(obj.data.phoneNumber)}}</span>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="!deliveryBoySelected && this.entryForm.get('deliveryBoyName')?.value"
            class="small-text error-msg bold-text mt-1">New
            delivery person ({{this.entryForm.get('deliveryBoyName')?.value}}) will be created!</div>
        <div class="mt-2 bold-text">New Entry details.</div>
        <div class="gap d-flex w-100 flex-wrap">
            <div class="box-input">
                <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Date</mat-label>
                    <input matInput [matDatepicker]="picker" formControlName="date" (focus)="onfocus('date')">
                    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>
            </div>
            <div class="box-input">
                <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Units Sent</mat-label>
                    <input matInput placeholder="5" [maxLength]="3" autocomplete="off" formControlName="unitsSent"
                        (focus)="onfocus('unitsSent')">
                </mat-form-field>
            </div>
            <div class="box-input">
                <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Units Recieved</mat-label>
                    <input matInput placeholder="5" [maxLength]="3" autocomplete="off" formControlName="unitsRecieved"
                        (focus)="onfocus('unitsRecieved')">
                </mat-form-field>
            </div>
            <div class="box-input">
                <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Rate/Unit</mat-label>
                    <input matInput placeholder="1400" [maxLength]="10" autocomplete="off" formControlName="rate"
                        (focus)="onfocus('rate')">
                </mat-form-field>
            </div>
            <div class="box-input">
                <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Paid Amount</mat-label>
                    <input matInput placeholder="1400" [maxLength]="10" autocomplete="off" formControlName="paidAmt"
                        (focus)="onfocus('paidAmt')">
                </mat-form-field>
            </div>
            <div class="box-input">
                <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Extra details</mat-label>
                    <input matInput placeholder="Payment might be delayed..." autocomplete="off"
                        formControlName="extraDetails" (focus)="onfocus('extraDetails')">
                </mat-form-field>
            </div>
        </div>
    </form>
    <div class="error-msg mt-2 bold-text" *ngIf="errorMessage">{{errorMessage}}</div>
    <div class="mt-3 justify-content-between d-flex customer-form flex-wrap gap-3">
        <div class="gap-3 d-flex flex-wrap">
            <button mat-flat-button (click)="onCancelClick()" class="custom-btn cancel-btn danger">Cancel</button>
            <button mat-flat-button (click)="onDeleteClick()" *ngIf="isEditing"
                class="custom-btn cancel-btn danger">Delete</button>
        </div>
        <button mat-flat-button (click)="onSaveClick()" class="save-btn" [disabled]="disableSave">Save</button>
    </div>
</div>